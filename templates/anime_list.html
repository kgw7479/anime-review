<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Anime Review</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <header class="site-header">
        <div class="site-header-inner">
            <div>
                <h1 class="logo">Anime Review</h1>
                <p class="logo-subtitle">ë‚´ê°€ ì¢‹ì•„í•˜ëŠ” ì• ë‹ˆë¥¼ ê¸°ë¡í•˜ëŠ” ì‘ì€ ë¦¬ë·° ì‚¬ì´íŠ¸</p>
            </div>
            <nav class="site-nav">
                <a href="/anime" class="nav-link active">ì• ë‹ˆ ëª©ë¡</a>
            </nav>
        </div>
    </header>

    <main class="container">
        <h2 class="section-title">ì• ë‹ˆ ëª©ë¡</h2>
        <p class="section-desc">ë¦¬ë·°ë¥¼ ë‚¨ê¸°ê³  ì‹¶ì€ ì‘í’ˆì„ í•˜ë‚˜ ê³¨ë¼ ìƒì„¸ í˜ì´ì§€ë¡œ ë“¤ì–´ê°€ ë³´ì„¸ìš”.</p>

        <!-- ğŸ” ê²€ìƒ‰ + í•„í„° ë°” -->
        <form class="search-bar" method="get" action="{{ url_for('anime_list') }}">
            <!-- ê²€ìƒ‰ì–´ ì…ë ¥ -->
            <input
                type="text"
                name="q"
                placeholder="ì‘í’ˆ ì œëª©ì„ ê²€ìƒ‰í•˜ì„¸ìš” (ì˜ˆ: í•˜ì´í, ë¸”ë£¨ë¡)"
                value="{{ q or '' }}">

            <!-- ì¥ë¥´ í•„í„° -->
            <select name="genre">
                <option value="">ì „ì²´ ì¥ë¥´</option>
                {% for g in genres %}
                    <option value="{{ g }}" {% if genre == g %}selected{% endif %}>
                        {{ g }}
                    </option>
                {% endfor %}
            </select>

            <!-- ì •ë ¬ ê¸°ì¤€ -->
            <select name="sort">
                <option value="title" {% if sort == 'title' %}selected{% endif %}>
                    ì œëª© ì˜¤ë¦„ì°¨ìˆœ
                </option>
                <option value="title_desc" {% if sort == 'title_desc' %}selected{% endif %}>
                    ì œëª© ë‚´ë¦¼ì°¨ìˆœ
                </option>
                <option value="rating_desc" {% if sort == 'rating_desc' %}selected{% endif %}>
                    í‰ì  ë†’ì€ ìˆœ
                </option>
                <option value="rating_asc" {% if sort == 'rating_asc' %}selected{% endif %}>
                    í‰ì  ë‚®ì€ ìˆœ
                </option>
            </select>

            <button type="submit">ê²€ìƒ‰</button>
        </form>

        {% if q or genre %}
            <p class="search-result-info">
                {% if q %}"{{ q }}" ê²€ìƒ‰ ê²°ê³¼ {% endif %}
                {% if genre %} (ì¥ë¥´: {{ genre }}){% endif %}
                â€“ <strong>{{ animes|length }}</strong>ê°œ ì‘í’ˆ
            </p>
        {% endif %}

        <ul class="anime-list">
            {% for anime in animes %}
                <li class="anime-item">
                    <a href="{{ url_for('anime_detail', anime_id=anime.id) }}" class="anime-link">
                        <img src="{{ url_for('static', filename=anime.image_url) }}"
                             alt="{{ anime.title }}"
                             class="anime-thumb">
                        <div class="anime-info">
                            <div class="anime-title-row">
                                <span class="title">{{ anime.title }}</span>
                            </div>
                            <div class="anime-meta-row">
                                <span class="badge-genre">{{ anime.genre }}</span>
                                {% if anime.avg_rating %}
                                    <span class="badge-rating">
                                        â˜… {{ "%.1f"|format(anime.avg_rating) }} / 10
                                    </span>
                                {% else %}
                                    <span class="badge-rating badge-rating-empty">
                                        ì•„ì§ ë³„ì  ì—†ìŒ
                                    </span>
                                {% endif %}
                            </div>
                        </div>
                    </a>
                </li>
            {% endfor %}
        </ul>
    </main>
</body>
</html>
